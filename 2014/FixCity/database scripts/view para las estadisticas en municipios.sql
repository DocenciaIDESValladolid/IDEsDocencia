insert into estado_ayto values 
(101, '2014-04-01', 0, '0001'),
(102, '2014-04-02', 0, '0001'),
(103, '2014-04-03', 0, '0001'),
(104, '2014-04-04', 0, '0001'),
(105, '2014-04-05', 0, '0002'),
(106, '2014-04-06', 0, '0002'),
(107, '2014-04-07', 0, '0002'),
(108, '2014-04-08', 0, '0002'),
(109, '2014-04-09', 0, '0003'),
(110, '2014-04-01', 0, '0003'),
(111, '2014-04-02', 0, '0003'),
(112, '2014-04-03', 0, '0003'),
(113, '2014-04-04', 0, '0003'),
(114, '2014-04-05', 0, '0003'),
(115, '2014-04-06', 0, '0003'),
(116, '2014-04-07', 0, '0004'),
(117, '2014-04-08', 0, '0004'),
(118, '2014-04-09', 0, '0005'),
(119, '2014-04-01', 0, '0006'),
(120, '2014-04-02', 0, '0006'),
(121, '2014-04-03', 0, '0006'),
(122, '2014-04-04', 0, '0006'),
(123, '2014-04-05', 0, '0006'),
(124, '2014-04-06', 0, '0006'),
(125, '2014-04-07', 0, '0006'),
(126, '2014-04-08', 0, '0006'),
(127, '2014-04-09', 0, '0007'),
(128, '2014-04-01', 0, '0007'),
(129, '2014-04-02', 0, '0008'),
(130, '2014-04-03', 0, '0008'),
(131, '2014-04-04', 0, '0009'),
(132, '2014-04-05', 0, '0009'),
(133, '2014-04-06', 0, '0009'),
(134, '2014-04-07', 0, '0009'),
(135, '2014-04-08', 0, '0009'),
(136, '2014-04-09', 0, '0009'),

(101, '2014-04-01', 1, '0001'),

(105, '2014-04-05', 1, '0002'),
(106, '2014-04-06', 1, '0002'),
(107, '2014-04-07', 1, '0002'),
(108, '2014-04-08', 1, '0002'),


(114, '2014-04-05', 1, '0003'),
(115, '2014-04-06', 1, '0003'),

(116, '2014-04-07', 1, '0004'),

(119, '2014-04-01', 1, '0006'),
(120, '2014-04-02', 1, '0006'),
(121, '2014-04-03', 1, '0006'),

(129, '2014-04-02', 1, '0008'),
(133, '2014-04-06', 1, '0009'),
(136, '2014-04-09', 1, '0009');


SELECT id_ayto, Round((AVG(estado)*2),4) AS Percentage , Round((AVG(estado))*COUNT(estado),0) AS Resolved, Count(estado)-Round((AVG(estado))*COUNT(estado),0) AS Total
FROM estado_ayto
GROUP BY id_ayto 
ORDER BY Percentage DESC
LIMIT 10;

SELECT id_ayto, COUNT(estado)
FROM estado_ayto
WHERE estado = 1
GROUP BY id_ayto;




SELECT id_ayto, 
	SUM(CASE WHEN estado=1 THEN 1 ELSE 0 END)*100/SUM(CASE WHEN estado=0 THEN 1 ELSE 0 END) AS Percentage,
	SUM(CASE WHEN estado=1 THEN 1 ELSE 0 END) AS Resolved,
	SUM(CASE WHEN estado=0 THEN 1 ELSE 0 END) AS Total
FROM estado_ayto
GROUP BY id_ayto
ORDER BY Percentage DESC
LIMIT 10;


